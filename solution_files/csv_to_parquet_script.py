import sys
from awsglue.transforms import *
from awsglue.utils import getResolvedOptions
from pyspark.context import SparkContext
from awsglue.context import GlueContext
from awsglue.job import Job

## @params: [JOB_NAME]
args = getResolvedOptions(sys.argv, ['JOB_NAME'])

sc = SparkContext()
glueContext = GlueContext(sc)
spark = glueContext.spark_session
job = Job(glueContext)
job.init(args['JOB_NAME'], args)
## @type: DataSource
## @args: [database = "csv-database", table_name = "yordan_solution_bucket", transformation_ctx = "datasource0"]
## @return: datasource0
## @inputs: []
datasource0 = glueContext.create_dynamic_frame.from_catalog(database = "csv-database", table_name = "yordan_solution_bucket", transformation_ctx = "datasource0")
## @type: ApplyMapping
## @args: [mapping = [("year", "long", "year", "long"), ("quarter", "long", "quarter", "long"), ("month", "long", "month", "long"), ("dayofmonth", "long", "dayofmonth", "long"), ("dayofweek", "long", "dayofweek", "long"), ("flightdate", "string", "flightdate", "string"), ("reporting_airline", "string", "reporting_airline", "string"), ("dot_id_reporting_airline", "long", "dot_id_reporting_airline", "long"), ("iata_code_reporting_airline", "string", "iata_code_reporting_airline", "string"), ("tail_number", "string", "tail_number", "string"), ("flight_number_reporting_airline", "long", "flight_number_reporting_airline", "long"), ("originairportid", "long", "originairportid", "long"), ("originairportseqid", "long", "originairportseqid", "long"), ("origincitymarketid", "long", "origincitymarketid", "long"), ("origin", "string", "origin", "string"), ("origincityname", "string", "origincityname", "string"), ("originstate", "string", "originstate", "string"), ("originstatefips", "long", "originstatefips", "long"), ("originstatename", "string", "originstatename", "string"), ("originwac", "long", "originwac", "long"), ("destairportid", "long", "destairportid", "long"), ("destairportseqid", "long", "destairportseqid", "long"), ("destcitymarketid", "long", "destcitymarketid", "long"), ("dest", "string", "dest", "string"), ("destcityname", "string", "destcityname", "string"), ("deststate", "string", "deststate", "string"), ("deststatefips", "long", "deststatefips", "long"), ("deststatename", "string", "deststatename", "string"), ("destwac", "long", "destwac", "long"), ("crsdeptime", "long", "crsdeptime", "long"), ("deptime", "long", "deptime", "long"), ("depdelay", "long", "depdelay", "long"), ("depdelayminutes", "long", "depdelayminutes", "long"), ("depdel15", "long", "depdel15", "long"), ("departuredelaygroups", "long", "departuredelaygroups", "long"), ("deptimeblk", "string", "deptimeblk", "string"), ("taxiout", "long", "taxiout", "long"), ("wheelsoff", "long", "wheelsoff", "long"), ("wheelson", "long", "wheelson", "long"), ("taxiin", "long", "taxiin", "long"), ("crsarrtime", "long", "crsarrtime", "long"), ("arrtime", "long", "arrtime", "long"), ("arrdelay", "long", "arrdelay", "long"), ("arrdelayminutes", "long", "arrdelayminutes", "long"), ("arrdel15", "long", "arrdel15", "long"), ("arrivaldelaygroups", "long", "arrivaldelaygroups", "long"), ("arrtimeblk", "string", "arrtimeblk", "string"), ("cancelled", "long", "cancelled", "long"), ("cancellationcode", "string", "cancellationcode", "string"), ("diverted", "long", "diverted", "long"), ("crselapsedtime", "long", "crselapsedtime", "long"), ("actualelapsedtime", "long", "actualelapsedtime", "long"), ("airtime", "long", "airtime", "long"), ("flights", "long", "flights", "long"), ("distance", "long", "distance", "long"), ("distancegroup", "long", "distancegroup", "long"), ("carrierdelay", "long", "carrierdelay", "long"), ("weatherdelay", "long", "weatherdelay", "long"), ("nasdelay", "long", "nasdelay", "long"), ("securitydelay", "long", "securitydelay", "long"), ("lateaircraftdelay", "long", "lateaircraftdelay", "long"), ("firstdeptime", "long", "firstdeptime", "long"), ("totaladdgtime", "double", "totaladdgtime", "double"), ("longestaddgtime", "double", "longestaddgtime", "double"), ("divairportlandings", "long", "divairportlandings", "long"), ("divreacheddest", "double", "divreacheddest", "double"), ("divactualelapsedtime", "string", "divactualelapsedtime", "string"), ("divarrdelay", "string", "divarrdelay", "string"), ("divdistance", "double", "divdistance", "double"), ("div1airport", "string", "div1airport", "string"), ("div1airportid", "long", "div1airportid", "long"), ("div1airportseqid", "long", "div1airportseqid", "long"), ("div1wheelson", "long", "div1wheelson", "long"), ("div1totalgtime", "double", "div1totalgtime", "double"), ("div1longestgtime", "double", "div1longestgtime", "double"), ("div1wheelsoff", "string", "div1wheelsoff", "string"), ("div1tailnum", "string", "div1tailnum", "string"), ("div2airport", "string", "div2airport", "string"), ("div2airportid", "string", "div2airportid", "string"), ("div2airportseqid", "string", "div2airportseqid", "string"), ("div2wheelson", "string", "div2wheelson", "string"), ("div2totalgtime", "string", "div2totalgtime", "string"), ("div2longestgtime", "string", "div2longestgtime", "string"), ("div2wheelsoff", "string", "div2wheelsoff", "string"), ("div2tailnum", "string", "div2tailnum", "string"), ("div3airport", "string", "div3airport", "string"), ("div3airportid", "string", "div3airportid", "string"), ("div3airportseqid", "string", "div3airportseqid", "string"), ("div3wheelson", "string", "div3wheelson", "string"), ("div3totalgtime", "string", "div3totalgtime", "string"), ("div3longestgtime", "string", "div3longestgtime", "string"), ("div3wheelsoff", "string", "div3wheelsoff", "string"), ("div3tailnum", "string", "div3tailnum", "string"), ("div4airport", "string", "div4airport", "string"), ("div4airportid", "string", "div4airportid", "string"), ("div4airportseqid", "string", "div4airportseqid", "string"), ("div4wheelson", "string", "div4wheelson", "string"), ("div4totalgtime", "string", "div4totalgtime", "string"), ("div4longestgtime", "string", "div4longestgtime", "string"), ("div4wheelsoff", "string", "div4wheelsoff", "string"), ("div4tailnum", "string", "div4tailnum", "string"), ("div5airport", "string", "div5airport", "string"), ("div5airportid", "string", "div5airportid", "string"), ("div5airportseqid", "string", "div5airportseqid", "string"), ("div5wheelson", "string", "div5wheelson", "string"), ("div5totalgtime", "string", "div5totalgtime", "string"), ("div5longestgtime", "string", "div5longestgtime", "string"), ("div5wheelsoff", "string", "div5wheelsoff", "string"), ("div5tailnum", "string", "div5tailnum", "string"), ("col109", "string", "col109", "string")], transformation_ctx = "applymapping1"]
## @return: applymapping1
## @inputs: [frame = datasource0]
applymapping1 = ApplyMapping.apply(frame = datasource0, mappings = [("year", "long", "year", "long"), ("quarter", "long", "quarter", "long"), ("month", "long", "month", "long"), ("dayofmonth", "long", "dayofmonth", "long"), ("dayofweek", "long", "dayofweek", "long"), ("flightdate", "string", "flightdate", "string"), ("reporting_airline", "string", "reporting_airline", "string"), ("dot_id_reporting_airline", "long", "dot_id_reporting_airline", "long"), ("iata_code_reporting_airline", "string", "iata_code_reporting_airline", "string"), ("tail_number", "string", "tail_number", "string"), ("flight_number_reporting_airline", "long", "flight_number_reporting_airline", "long"), ("originairportid", "long", "originairportid", "long"), ("originairportseqid", "long", "originairportseqid", "long"), ("origincitymarketid", "long", "origincitymarketid", "long"), ("origin", "string", "origin", "string"), ("origincityname", "string", "origincityname", "string"), ("originstate", "string", "originstate", "string"), ("originstatefips", "long", "originstatefips", "long"), ("originstatename", "string", "originstatename", "string"), ("originwac", "long", "originwac", "long"), ("destairportid", "long", "destairportid", "long"), ("destairportseqid", "long", "destairportseqid", "long"), ("destcitymarketid", "long", "destcitymarketid", "long"), ("dest", "string", "dest", "string"), ("destcityname", "string", "destcityname", "string"), ("deststate", "string", "deststate", "string"), ("deststatefips", "long", "deststatefips", "long"), ("deststatename", "string", "deststatename", "string"), ("destwac", "long", "destwac", "long"), ("crsdeptime", "long", "crsdeptime", "long"), ("deptime", "long", "deptime", "long"), ("depdelay", "long", "depdelay", "long"), ("depdelayminutes", "long", "depdelayminutes", "long"), ("depdel15", "long", "depdel15", "long"), ("departuredelaygroups", "long", "departuredelaygroups", "long"), ("deptimeblk", "string", "deptimeblk", "string"), ("taxiout", "long", "taxiout", "long"), ("wheelsoff", "long", "wheelsoff", "long"), ("wheelson", "long", "wheelson", "long"), ("taxiin", "long", "taxiin", "long"), ("crsarrtime", "long", "crsarrtime", "long"), ("arrtime", "long", "arrtime", "long"), ("arrdelay", "long", "arrdelay", "long"), ("arrdelayminutes", "long", "arrdelayminutes", "long"), ("arrdel15", "long", "arrdel15", "long"), ("arrivaldelaygroups", "long", "arrivaldelaygroups", "long"), ("arrtimeblk", "string", "arrtimeblk", "string"), ("cancelled", "long", "cancelled", "long"), ("cancellationcode", "string", "cancellationcode", "string"), ("diverted", "long", "diverted", "long"), ("crselapsedtime", "long", "crselapsedtime", "long"), ("actualelapsedtime", "long", "actualelapsedtime", "long"), ("airtime", "long", "airtime", "long"), ("flights", "long", "flights", "long"), ("distance", "long", "distance", "long"), ("distancegroup", "long", "distancegroup", "long"), ("carrierdelay", "long", "carrierdelay", "long"), ("weatherdelay", "long", "weatherdelay", "long"), ("nasdelay", "long", "nasdelay", "long"), ("securitydelay", "long", "securitydelay", "long"), ("lateaircraftdelay", "long", "lateaircraftdelay", "long"), ("firstdeptime", "long", "firstdeptime", "long"), ("totaladdgtime", "double", "totaladdgtime", "double"), ("longestaddgtime", "double", "longestaddgtime", "double"), ("divairportlandings", "long", "divairportlandings", "long"), ("divreacheddest", "double", "divreacheddest", "double"), ("divactualelapsedtime", "string", "divactualelapsedtime", "string"), ("divarrdelay", "string", "divarrdelay", "string"), ("divdistance", "double", "divdistance", "double"), ("div1airport", "string", "div1airport", "string"), ("div1airportid", "long", "div1airportid", "long"), ("div1airportseqid", "long", "div1airportseqid", "long"), ("div1wheelson", "long", "div1wheelson", "long"), ("div1totalgtime", "double", "div1totalgtime", "double"), ("div1longestgtime", "double", "div1longestgtime", "double"), ("div1wheelsoff", "string", "div1wheelsoff", "string"), ("div1tailnum", "string", "div1tailnum", "string"), ("div2airport", "string", "div2airport", "string"), ("div2airportid", "string", "div2airportid", "string"), ("div2airportseqid", "string", "div2airportseqid", "string"), ("div2wheelson", "string", "div2wheelson", "string"), ("div2totalgtime", "string", "div2totalgtime", "string"), ("div2longestgtime", "string", "div2longestgtime", "string"), ("div2wheelsoff", "string", "div2wheelsoff", "string"), ("div2tailnum", "string", "div2tailnum", "string"), ("div3airport", "string", "div3airport", "string"), ("div3airportid", "string", "div3airportid", "string"), ("div3airportseqid", "string", "div3airportseqid", "string"), ("div3wheelson", "string", "div3wheelson", "string"), ("div3totalgtime", "string", "div3totalgtime", "string"), ("div3longestgtime", "string", "div3longestgtime", "string"), ("div3wheelsoff", "string", "div3wheelsoff", "string"), ("div3tailnum", "string", "div3tailnum", "string"), ("div4airport", "string", "div4airport", "string"), ("div4airportid", "string", "div4airportid", "string"), ("div4airportseqid", "string", "div4airportseqid", "string"), ("div4wheelson", "string", "div4wheelson", "string"), ("div4totalgtime", "string", "div4totalgtime", "string"), ("div4longestgtime", "string", "div4longestgtime", "string"), ("div4wheelsoff", "string", "div4wheelsoff", "string"), ("div4tailnum", "string", "div4tailnum", "string"), ("div5airport", "string", "div5airport", "string"), ("div5airportid", "string", "div5airportid", "string"), ("div5airportseqid", "string", "div5airportseqid", "string"), ("div5wheelson", "string", "div5wheelson", "string"), ("div5totalgtime", "string", "div5totalgtime", "string"), ("div5longestgtime", "string", "div5longestgtime", "string"), ("div5wheelsoff", "string", "div5wheelsoff", "string"), ("div5tailnum", "string", "div5tailnum", "string"), ("col109", "string", "col109", "string")], transformation_ctx = "applymapping1")
## @type: ResolveChoice
## @args: [choice = "make_struct", transformation_ctx = "resolvechoice2"]
## @return: resolvechoice2
## @inputs: [frame = applymapping1]
resolvechoice2 = ResolveChoice.apply(frame = applymapping1, choice = "make_struct", transformation_ctx = "resolvechoice2")
## @type: DropNullFields
## @args: [transformation_ctx = "dropnullfields3"]
## @return: dropnullfields3
## @inputs: [frame = resolvechoice2]
dropnullfields3 = DropNullFields.apply(frame = resolvechoice2, transformation_ctx = "dropnullfields3")
## @type: DataSink
## @args: [connection_type = "s3", connection_options = {"path": "s3://yordan-solution-bucket"}, format = "parquet", transformation_ctx = "datasink4"]
## @return: datasink4
## @inputs: [frame = dropnullfields3]
datasink4 = glueContext.write_dynamic_frame.from_options(frame = dropnullfields3, connection_type = "s3", connection_options = {"path": "s3://yordan-solution-bucket"}, format = "parquet", transformation_ctx = "datasink4")
job.commit()